var LOG_BDS_CONSTANTS = { WEB_ALL_DOMAIN: ".batdongsan.com.vn", WEB_DOMAIN: "batdongsan.com.vn", WEB_KEY_API: "bds" }, LOG_CONSTANTS = { BATDONGSAN_WEB_ID: 1, TOPBANK_WEB_ID: 2, BANXEHOI_WEB_ID: 3, TINNHAC_WEB_ID: 4, TINXE_WEB_ID: 5, CHOBROD_WEB_ID: 6, CINTAMOBIL_WEB_ID: 7, PHIKOTSE_WEB_ID: 8, version: 10, URL: { EXPERIMENTAL_DESIGN_JS: "https://log." + LOG_BDS_CONSTANTS.WEB_DOMAIN + "/js/bds/ed.js?v=" + new Date().toJSON().slice(0, 10), LINK_GET_GEO_IP_ADDRESS: "//geoip.nekudo.com/api/", USER_HANDLER: "/HandlerWeb/UserHandler.ashx?type=getuserstatus", LOG_SERVER: "https://log." + LOG_BDS_CONSTANTS.WEB_DOMAIN + "/" + LOG_BDS_CONSTANTS.WEB_KEY_API + "lp", LOG_SERVER_IMAGE_REQUEST: "https://log." + LOG_BDS_CONSTANTS.WEB_DOMAIN + "/" + LOG_BDS_CONSTANTS.WEB_KEY_API + "lg" }, COOKIE: { USER_INFO_KEY_COOKIE: "uitb", USER_SESSION_KEY: "usidtb", SESSION_KEY: "sidtb" }, LOCAL_STORAGE: { IP_LOCATION_ADDRESS_KEY: "ipLocationAdress", LOG_CLICK_COOKIE_KEY: "logClickCookie", LOG_ENTER_UP_COOKIE_KEY: "logEnterUpCookie", VERSIONS: "experimental_design_versions", TIME_ON_SITE_ONLY: "time_on_site", LOG_TIME_ON_SITE_KEY: "logTimeOnSitePreviousPage" }, CLIENT_IP: { KEY_IP_ADDRESS_RESPONSE: "ip", KEY_CITY_ADDRESS_RESPONSE: "city", KEY_REGION_ADDRESS_RESPONSE: "city", KEY_COUNTRY_ADDRESS_RESPONSE: "country", KEY_COUNTRY_NAME_ADDRESS_RESPONSE: "name" }, SEND_LOG_TYPE: { IMAGE: "image", XHR: "xhr", BEACON: "beacon" }, ACTION_TYPE: { PAGE_VIEW: 185, WINDOW_SCROLL: 188, CLICK_LOCATION: 189, CLICK_LINK_NOIBAT: 190, MOUSE_CLICK: 191, MOUSE_MOVE_OVER: 192, MOUSE_MOVE_STOP: 193, UNLOAD: 194, ENTER_UP: 195 }, THRESHOLD: { COOKIE_LENGTH: 32, TOKEN_LENGTH: 32, GET_REQUEST_MAX_LENGTH: 2048, USER_SESSION_TIMEOUT: 3650, SROLL_PIXEL_MAX: 400, MOUSE_MOUVE_STOP_TIMEOUT: 1e3, SEARCH_BOX_TAG_TIMEOUT: 300, SCROLL_TIMEOUT: 1e3, IP_ADDRESS_COOKIE_TIMEOUT: 12 / 24, USER_INFO_KEY_COOKIE: 3650, MAX_LENGTH_OUTER_HTML: 512 }, KEY_CODE: { ENTER: 13, UP: 38, DOWN: 40, PAGE_UP: 33, PAGE_DOWN: 34 }, current_pagey_offset: 0, ID_SEARCH_BOXS: ["txt1", "txtAutoComplete", "email", "txtChatPhoneNumber", "txtChatName", "txtChatEmail", "txtName", "txtEmail", "txtMobile", "txtLink", "txtContent"], CSS_OBJECT_LOG_MOUSE_MOVES: [] }, globalVar = { lastPressKeyTime: 0, currentKeycode: 0, lastScrollTime: 0, lastMouseMoveStopTime: 0, mousePositionX: -1, mousePositionY: -1, isLogPageView: !1, loggerAndSearchTextBox: !1, addMouseClickEvent: !1, addMouseMoveAndStopEvent: !1, addScrollLog: !1, addBeforeUnload: !1, tracking: !1, start_time_active_tab: 0, is_active: !0, time_on_site: new Number(0), ip_cache_time: 18e5, url_get_ip: "https://api.ipify.org?format=jsonp&callback=?" }, userInfo = { id: "", name: "", email: "", mobile: "", age: "0", identify_card_number: "0", time: 0 }; function Logger() { try { function t(t) { var n, a; n = Array.prototype.forEach, a = Array.prototype.map, this.each = function (t, a, o) { if (null !== t) if (n && t.forEach === n) t.forEach(a, o); else if (t.length === +t.length) { for (var r = 0, d = t.length; r < d; r++) if ({} === a.call(o, t[r], r, t)) return; } else for (var s in t) if (t.hasOwnProperty(s) && {} === a.call(o, t[s], s, t)) return }, this.map = function (t, i, n) { var o = []; return null == t ? o : a && t.map === a ? t.map(i, n) : (this.each(t, function (t, a, r) { o[o.length] = i.call(n, t, a, r) }), o) }, "object" == typeof t ? (this.hasher = t.hasher, this.screen_resolution = t.screen_resolution, this.screen_orientation = t.screen_orientation, this.canvas = t.canvas, this.ie_activex = t.ie_activex) : "function" == typeof t && (this.hasher = t) } function n() { this.i, this.o } function a(i, n) { this.user_id = 123123123, this.email = userInfo.email, this.mobile = userInfo.mobile, this.name = userInfo.name, this.age = userInfo.age, this.id_card = userInfo.identify_card_number; try { var a = localStorage.getItem(LOG_CONSTANTS.LOCAL_STORAGE.VERSIONS); if (a && a != null && "" != a) { var o = JSON.parse(a); o && o != null && o.value && o.value != null && "" != o.value && (this.version = o.value) } } catch (t) { console.log(t) } this.action_id = i; try { this.data = JSON.stringify(n) } catch (t) { console.log(t) } this.web_id = LOG_CONSTANTS.BATDONGSAN_WEB_ID, this.mouse_pos_x = globalVar.mousePositionX, this.mouse_pos_y = globalVar.mousePositionY, this.page_y_offset = window.pageYOffset, this.page_x_offset = window.pageXOffset, this.scroll_width = document.documentElement.scrollWidth, this.scroll_height = document.documentElement.scrollHeight, this.current_uri = document.URL, this.refer_uri = document.referrer, this.time = new Date().getTime(), this.session_id, this.user_session_id, this.browser_finger_print, this.screen_width, this.screen_height, this.browser_width, this.browser_height, this.os_info, this.browser_info, this.is_mobile, this.ip_address = "", this.city = "", this.region = "", this.country = "", this.send_time, this.prepareLogObjectData = function (i) { this.session_id = i.getSessionId(), this.user_session_id = i.getUserSessionId(), this.browser_finger_print = new t().get(); var n = i.getBrowserAndOSInfo(); this.screen_width = n.screenWidth, this.screen_height = n.screenHeight, this.browser_width = window.innerWidth, this.browser_height = window.innerHeight, this.os_info = n.os + " " + n.osVersion, this.browser_info = n.browser + " " + n.browserMajorVersion + " (" + n.browserVersion + ")\n", this.is_mobile = n.mobile; var a = i.getIPLocationAddress(); a && a != null ? (this.ip_address = a[LOG_CONSTANTS.CLIENT_IP.KEY_IP_ADDRESS_RESPONSE], this.city = a[LOG_CONSTANTS.CLIENT_IP.KEY_CITY_ADDRESS_RESPONSE], this.region = a[LOG_CONSTANTS.CLIENT_IP.KEY_REGION_ADDRESS_RESPONSE], this.country = a[LOG_CONSTANTS.CLIENT_IP.KEY_COUNTRY_ADDRESS_RESPONSE]) : $.getJSON("//api.ipify.org?format=jsonp&callback=?", function (t) { var i = {}; i[LOG_CONSTANTS.CLIENT_IP.KEY_IP_ADDRESS_RESPONSE] = t.ip, localStorage.setItem(LOG_CONSTANTS.LOCAL_STORAGE.IP_LOCATION_ADDRESS_KEY, JSON.stringify(i)) }) } } function o() { this.i, this.uid, this.h, this.t, this.p, this.a, this.o, this.ad, this.gy, this.ey, this.gx, this.ex, this.pt, this.dp, this.dn, this.zn, this.loc } function r() { this.timeOnSite, this.timestamp, this.target = {}, this.searchContent, this.ci, this.di, this.wi, this.si, this.pi, this.cc, this.uid, this.vdi = new o, this.vdis = [], this.vdns = [], this.is = [], this.titleFooter } this.getXHR = function () { return window.XMLHttpRequest ? new XMLHttpRequest : new ActiveXObject("Microsoft.XMLHTTP") }, this.makeId = function (t) { for (var n = "", a = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789", o = 0; o < t; o++) n += a.charAt(Math.floor(Math.random() * a.length)); return n }, this.createLogObject = function (t, i) { return new a(t, i) }, this.createData = function () { return new r }, t.prototype = { get: function () { var t = [navigator.userAgent, navigator.language, screen.colorDepth]; if (this.screen_resolution) { var i = this.getScreenResolution(); "undefined" != typeof i && t.push(i.join("x")) } return t.push(new Date().getTimezoneOffset()), t.push(this.hasSessionStorage()), t.push(this.hasLocalStorage()), t.push(!!window.indexedDB), document.body ? t.push(typeof document.body.addBehavior) : t.push("undefined"), t.push(typeof window.openDatabase), t.push(navigator.cpuClass), t.push(navigator.platform), t.push(navigator.doNotTrack), t.push(this.getPluginsString()), this.canvas && this.isCanvasSupported() && t.push(this.getCanvasFingerprint()), this.hasher ? this.hasher(t.join("###"), 31) : this.murmurhash3_32_gc(t.join("###"), 31) }, murmurhash3_32_gc: function (t, n) { var a, o, r, d, s, g, l, c; for (a = 3 & t.length, o = t.length - a, r = n, s = 3432918353, g = 461845907, c = 0; c < o;) l = 255 & t.charCodeAt(c) | (255 & t.charCodeAt(++c)) << 8 | (255 & t.charCodeAt(++c)) << 16 | (255 & t.charCodeAt(++c)) << 24, ++c, l = 4294967295 & (65535 & l) * s + ((65535 & (l >>> 16) * s) << 16), l = l << 15 | l >>> 17, l = 4294967295 & (65535 & l) * g + ((65535 & (l >>> 16) * g) << 16), r ^= l, r = r << 13 | r >>> 19, d = 4294967295 & 5 * (65535 & r) + ((65535 & 5 * (r >>> 16)) << 16), r = (65535 & d) + 27492 + ((65535 & (d >>> 16) + 58964) << 16); switch (l = 0, a) { case 3: l ^= (255 & t.charCodeAt(c + 2)) << 16; case 2: l ^= (255 & t.charCodeAt(c + 1)) << 8; case 1: l ^= 255 & t.charCodeAt(c), l = 4294967295 & (65535 & l) * s + ((65535 & (l >>> 16) * s) << 16), l = l << 15 | l >>> 17, l = 4294967295 & (65535 & l) * g + ((65535 & (l >>> 16) * g) << 16), r ^= l; } return r ^= t.length, r ^= r >>> 16, r = 4294967295 & 2246822507 * (65535 & r) + ((65535 & 2246822507 * (r >>> 16)) << 16), r ^= r >>> 13, r = 4294967295 & 3266489909 * (65535 & r) + ((65535 & 3266489909 * (r >>> 16)) << 16), r ^= r >>> 16, r >>> 0 }, hasLocalStorage: function () { try { return !!window.localStorage } catch (t) { return !0 } }, hasSessionStorage: function () { try { return !!window.sessionStorage } catch (t) { return !0 } }, isCanvasSupported: function () { var t = document.createElement("canvas"); return !!(t.getContext && t.getContext("2d")) }, isIE: function () { if ("Microsoft Internet Explorer" === navigator.appName) return !0; return !!("Netscape" === navigator.appName && /Trident/.test(navigator.userAgent)) }, getPluginsString: function () { return this.isIE() && this.ie_activex ? this.getIEPluginsString() : this.getRegularPluginsString() }, getRegularPluginsString: function () { return this.map(navigator.plugins, function (t) { var i = this.map(t, function (t) { return [t.type, t.suffixes].join("~") }).join(","); return [t.name, t.description, i].join("::") }, this).join(";") }, getIEPluginsString: function () { if (window.ActiveXObject) { return this.map(["ShockwaveFlash.ShockwaveFlash", "AcroPDF.PDF", "PDF.PdfCtrl", "QuickTime.QuickTime", "rmocx.RealPlayer G2 Control", "rmocx.RealPlayer G2 Control.1", "RealPlayer.RealPlayer(tm) ActiveX Control (32-bit)", "RealVideo.RealVideo(tm) ActiveX Control (32-bit)", "RealPlayer", "SWCtl.SWCtl", "WMPlayer.OCX", "AgControl.AgControl", "Skype.Detection"], function (t) { try { return new ActiveXObject(t), t } catch (t) { return null } }).join(";") } return "" }, getScreenResolution: function () { var t; return t = this.screen_orientation ? screen.height > screen.width ? [screen.height, screen.width] : [screen.width, screen.height] : [screen.height, screen.width], t }, getCanvasFingerprint: function () { var t = document.createElement("canvas"), i = t.getContext("2d"), n = "logger" + LOG_BDS_CONSTANTS.WEB_ALL_DOMAIN; return i.textBaseline = "top", i.font = "14px 'Arial'", i.textBaseline = "alphabetic", i.fillStyle = "#f60", i.fillRect(125, 1, 62, 20), i.fillStyle = "#069", i.fillText(n, 2, 15), i.fillStyle = "rgba(102, 204, 0, 0.7)", i.fillText(n, 4, 17), t.toDataURL() } }, this.getSessionId = function () { var t = this.getCookie(LOG_CONSTANTS.COOKIE.SESSION_KEY); return t && null != t && "" != t ? (this.setCookie(LOG_CONSTANTS.COOKIE.SESSION_KEY, t), t) : (t = this.makeId(LOG_CONSTANTS.THRESHOLD.COOKIE_LENGTH), this.setCookie(LOG_CONSTANTS.COOKIE.SESSION_KEY, t), t) }, this.getUserSessionId = function () { var t = this.getCookie(LOG_CONSTANTS.COOKIE.USER_SESSION_KEY); return t && null != t && "" != t ? (this.setCookie(LOG_CONSTANTS.COOKIE.USER_SESSION_KEY, t, LOG_CONSTANTS.THRESHOLD.USER_SESSION_TIMEOUT), t) : (t = this.makeId(LOG_CONSTANTS.THRESHOLD.COOKIE_LENGTH), this.setCookie(LOG_CONSTANTS.COOKIE.USER_SESSION_KEY, t, LOG_CONSTANTS.THRESHOLD.USER_SESSION_TIMEOUT), t) }, this.getCurrentURI = function () { return document.URL }, this.setCookie = function (t, i, n) { var a = "", o = new Date; if ("undefined" != typeof n) o.setTime(o.getTime() + 1e3 * (60 * (60 * (24 * n)))), a = "expires=" + o.toUTCString(); else { var r = new Date(o.getFullYear(), o.getMonth() + 1, o.getDate() + 1); o.setTime(Math.min(o.getTime() + 1800000, r.getTime())), a = "expires=" + o.toUTCString() } document.cookie = t + "=" + i + ";" + a + ";path=/;domain=" + LOG_BDS_CONSTANTS.WEB_ALL_DOMAIN }, this.getCookie = function (t) { for (var n, a = t + "=", o = document.cookie.split(";"), r = 0; r < o.length; r++) { for (n = o[r]; " " == n.charAt(0) ;) n = n.substring(1); if (0 == n.indexOf(a)) return n.substring(a.length, n.length) } return "" }, this.sendLog = function (t) { t.sendTime = new Date().getTime(); var i = encodeURIComponent(JSON.stringify(t)); i.length < LOG_CONSTANTS.THRESHOLD.GET_REQUEST_MAX_LENGTH ? this.sendLogByGetImageRequest(t) : this.postLogXHR(t) }, this.sendLogByGetImageRequest = function (t) { var i = JSON.stringify(t), n = new Image; n.style.display = "none", n.onload = function () { document.body.appendChild(n) }, n.src = LOG_CONSTANTS.URL.LOG_SERVER_IMAGE_REQUEST + "?log=" + encodeURIComponent(i), this.processRemoveLocalStorage(t) }, this.processRemoveLocalStorage = function (t) { t.action_id == LOG_CONSTANTS.ACTION_TYPE.MOUSE_CLICK ? localStorage.removeItem(LOG_CONSTANTS.LOCAL_STORAGE.LOG_CLICK_COOKIE_KEY + t.time) : t.action_id == LOG_CONSTANTS.ACTION_TYPE.ENTER_UP ? localStorage.removeItem(LOG_CONSTANTS.LOCAL_STORAGE.LOG_ENTER_UP_COOKIE_KEY + t.time) : t.action_id == LOG_CONSTANTS.ACTION_TYPE.UNLOAD && localStorage.removeItem(LOG_CONSTANTS.LOCAL_STORAGE.LOG_TIME_ON_SITE_KEY + t.time) }, this.sendXHRLog = function (t) { t.sendTime = new Date().getTime(), this.postLogXHR(t) }, this.postLogXHR = function (t) { var i = JSON.stringify(t); try { var n = this.getXHR(); n.onreadystatechange = function () { n.readyState == XMLHttpRequest.DONE && 200 <= n.status && 300 > n.status && logger.processRemoveLocalStorage(t) }, n.open("POST", LOG_CONSTANTS.URL.LOG_SERVER, !0), n.setRequestHeader("Content-type", "application/json;charset=utf-8"), n.setRequestHeader("Content-Encoding", "gzip"), n.withCredentials = !0, n.send(i) } catch (t) { globalVar.tracking && console.log(t) } }, this.getIPLocationAddressFromAPI = function () { $.getJSON("//api.ipify.org?format=jsonp&callback=?", function (t) { var i = {}; i[LOG_CONSTANTS.CLIENT_IP.KEY_IP_ADDRESS_RESPONSE] = t.ip, localStorage.setItem(LOG_CONSTANTS.LOCAL_STORAGE.IP_LOCATION_ADDRESS_KEY, JSON.stringify(i)) }) }, this.getIPLocationAddressLocal = function () { try { window.RTCPeerConnection = window.RTCPeerConnection || window.mozRTCPeerConnection || window.webkitRTCPeerConnection; var t = new RTCPeerConnection({ iceServers: [] }), i = function () { }; t.createDataChannel(""), t.createOffer(t.setLocalDescription.bind(t), i), t.onicecandidate = function (n) { if (n && n.candidate && n.candidate.candidate) { var a = /([0-9]{1,3}(\.[0-9]{1,3}){3}|[a-f0-9]{1,4}(:[a-f0-9]{1,4}){7})/.exec(n.candidate.candidate)[1], o = {}; o[LOG_CONSTANTS.CLIENT_IP.KEY_IP_ADDRESS_RESPONSE] = a, localStorage.setItem(LOG_CONSTANTS.LOCAL_STORAGE.IP_LOCATION_ADDRESS_KEY, JSON.stringify(o)), t.onicecandidate = i } } } catch (t) { globalVar.tracking && console.log(t) } return null }, this.getIPLocationAddress = function () { var t = localStorage.getItem(LOG_CONSTANTS.LOCAL_STORAGE.IP_LOCATION_ADDRESS_KEY); try { if (t && t != null && "" != t) return JSON.parse(t) } catch (t) { globalVar.tracking && console.log(t) } return null }, this.getLocationFromElement = function (t, i) { try { i.gy = t.getBoundingClientRect().top - document.body.getBoundingClientRect().top } catch (t) { globalVar.tracking && console.log(t) } try { i.gx = t.getBoundingClientRect().left - document.body.getBoundingClientRect().left } catch (t) { globalVar.tracking && console.log(t) } try { i.ey = t.offsetHeight } catch (t) { globalVar.tracking && console.log(t) } try { i.ex = t.offsetWidth } catch (t) { globalVar.tracking && console.log(t) } }, this.getInputData = function () { for (var t = [], a = document.querySelectorAll("input[type=\"text\"],input[type=\"file\"],input[type=\"email\"],input[type=\"datetime-local\"],input[type=\"date\"],input[type=\"color\"],input[type=\"checkbox\"]"), o = 0; o < a.length; o++) { var r = a[o], d = new n; d.i = r.value, r.outerHTML && r.outerHTML != null && "" != r.outerHTML && (r.outerHTML.length > LOG_CONSTANTS.THRESHOLD.MAX_LENGTH_OUTER_HTML / 16 ? d.o = r.outerHTML.substring(0, Math.max(LOG_CONSTANTS.THRESHOLD.MAX_LENGTH_OUTER_HTML / 16, r.outerHTML.indexOf(">") + 1)) : d.o = r.outerHTML), t[o] = d } return t }, this.getDescriptionDesktop = function () { var t = document.querySelector("div[class=\"Title\"] div[class=\"Footer\"]"); if (null != t) { for (var n = t.childNodes, a = [], o = 0; o < n.length; o++) a[o] = n[o].textContent.trim(); return a } return null }, this.getDescriptionMobile = function () { var t = [], n = 0, a = document.querySelector("div[class=\"sr-title\"] h1"); null != a && null != a && (t[n] = a.innerText.trim(), n++); var o = document.querySelectorAll("div[class=\"sr-title\"] div[class=\"div-plance\"] div"); if (null != o && null != o) for (var r, d = 0; d < o.length; d++) if (r = o[d], null != r && null != r) { var s = r.childNodes; if (null != s && null != s) for (var g = 0; g < s.length; g++) t[n] = s[g].textContent.trim(), n++ } return a = document.querySelector("div[class^=\"sr-title\"] div[class=\"div-count\"]"), null != a && (t[n] = a.innerText.trim()), t }, this.getBrowserAndOSInfo = function () { return null == window.jscd && this.extractBrowserAndOSInfo(), window.jscd }, this.extractBrowserAndOSInfo = function () { var t = ""; screen.width && (width = screen.width ? screen.width : "", height = screen.height ? screen.height : "", t += "" + width + " x " + height); var i, n, a, o = navigator.appVersion, r = navigator.userAgent, d = navigator.appName, s = "" + parseFloat(navigator.appVersion), g = parseInt(navigator.appVersion, 10); -1 != (n = r.indexOf("Opera")) && (d = "Opera", s = r.substring(n + 6), -1 != (n = r.indexOf("Version")) && (s = r.substring(n + 8))), -1 == (n = r.indexOf("OPR")) ? -1 == (n = r.indexOf("Edge")) ? -1 == (n = r.indexOf("MSIE")) ? -1 == (n = r.indexOf("Chrome")) ? -1 == (n = r.indexOf("Safari")) ? -1 == (n = r.indexOf("Firefox")) ? -1 == r.indexOf("Trident/") ? (i = r.lastIndexOf(" ") + 1) < (n = r.lastIndexOf("/")) && (d = r.substring(i, n), s = r.substring(n + 1), d.toLowerCase() == d.toUpperCase() && (d = navigator.appName)) : (d = "Microsoft Internet Explorer", s = r.substring(r.indexOf("rv:") + 3)) : (d = "Firefox", s = r.substring(n + 8)) : (d = "Safari", s = r.substring(n + 7), -1 != (n = r.indexOf("Version")) && (s = r.substring(n + 8))) : (d = "Chrome", s = r.substring(n + 7)) : (d = "Microsoft Internet Explorer", s = r.substring(n + 5)) : (d = "Microsoft Edge", s = r.substring(n + 5)) : (d = "Opera", s = r.substring(n + 4)), -1 != (a = s.indexOf(";")) && (s = s.substring(0, a)), -1 != (a = s.indexOf(" ")) && (s = s.substring(0, a)), -1 != (a = s.indexOf(")")) && (s = s.substring(0, a)), g = parseInt("" + s, 10), isNaN(g) && (s = "" + parseFloat(navigator.appVersion), g = parseInt(navigator.appVersion, 10)); var l = /Mobile|mini|Fennec|Android|iP(ad|od|hone)/.test(o), c = !!navigator.cookieEnabled; "undefined" != typeof navigator.cookieEnabled || c || (document.cookie = "testcookie", c = -1 != document.cookie.indexOf("testcookie")); var u = "-", m = [{ s: "Windows 10", r: /(Windows 10.0|Windows NT 10.0)/ }, { s: "Windows 8.1", r: /(Windows 8.1|Windows NT 6.3)/ }, { s: "Windows 8", r: /(Windows 8|Windows NT 6.2)/ }, { s: "Windows 7", r: /(Windows 7|Windows NT 6.1)/ }, { s: "Windows Vista", r: /Windows NT 6.0/ }, { s: "Windows Server 2003", r: /Windows NT 5.2/ }, { s: "Windows XP", r: /(Windows NT 5.1|Windows XP)/ }, { s: "Windows 2000", r: /(Windows NT 5.0|Windows 2000)/ }, { s: "Windows ME", r: /(Win 9x 4.90|Windows ME)/ }, { s: "Windows 98", r: /(Windows 98|Win98)/ }, { s: "Windows 95", r: /(Windows 95|Win95|Windows_95)/ }, { s: "Windows NT 4.0", r: /(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/ }, { s: "Windows CE", r: /Windows CE/ }, { s: "Windows 3.11", r: /Win16/ }, { s: "Android", r: /Android/ }, { s: "Open BSD", r: /OpenBSD/ }, { s: "Sun OS", r: /SunOS/ }, { s: "Linux", r: /(Linux|X11)/ }, { s: "iOS", r: /(iPhone|iPad|iPod)/ }, { s: "Mac OS X", r: /Mac OS X/ }, { s: "Mac OS", r: /(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/ }, { s: "QNX", r: /QNX/ }, { s: "UNIX", r: /UNIX/ }, { s: "BeOS", r: /BeOS/ }, { s: "OS/2", r: /OS\/2/ }, { s: "Search Bot", r: /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/ }]; for (var h in m) { var p = m[h]; if (p.r.test(r)) { u = p.s; break } } var E = "-"; /Windows/.test(u) && (E = /Windows (.*)/.exec(u)[1], u = "Windows"); "Mac OS X" === u ? E = /Mac OS X (10[\.\_\d]+)/.exec(r)[1] : "Android" === u ? E = /Android ([\.\_\d]+)/.exec(r)[1] : "iOS" === u ? (E = /OS (\d+)_(\d+)_?(\d+)?/.exec(o), E = E[1] + "." + E[2] + "." + (0 | E[3])) : void 0; var _ = "no check"; if ("undefined" != typeof swfobject) { var S = swfobject.getFlashPlayerVersion(); _ = 0 < S.major ? S.major + "." + S.minor + " r" + S.release : "-" } window.jscd = { screen: t, screenWidth: width, screenHeight: height, browser: d, browserVersion: s, browserMajorVersion: g, mobile: l, os: u, osVersion: E, cookies: c, flashVersion: _ } }, this.pageViewLog = function () { var t = document.URL, i = null; 0 <= t.indexOf("//m.") && 0 <= t.indexOf(LOG_BDS_CONSTANTS.WEB_DOMAIN) ? (i = this.getPageViewDataMobile(), i.is = this.getInputData()) : (i = this.getPageViewDataDesktop(), i.is = this.getInputData()), null == this.parseIdFromUrl(t) && (0 <= t.indexOf("//m.") && 0 <= t.indexOf(LOG_BDS_CONSTANTS.WEB_DOMAIN) ? i.titleFooter = this.getDescriptionMobile() : i.titleFooter = this.getDescriptionDesktop()); var n = this.createLogObject(LOG_CONSTANTS.ACTION_TYPE.PAGE_VIEW, i); n.prepareLogObjectData(this), this.sendXHRLog(n) }, this.mouseClickLog = function (t) { try { var n = t.target || t.srcElement, a = this.createData(); if (null != n && n != null) { try { for (var o, r = n.attributes, d = 0; d < r.length; d++) o = r[d], a.target[o.nodeName] = o.nodeValue } catch (t) { globalVar.tracking && console.log(t) } try { a.target.tagName = n.tagName } catch (t) { globalVar.tracking && console.log(t) } var s = n.parentElement; if (null == s || s == null); else { try { for (var o, r = s.attributes, d = 0; d < r.length; d++) o = r[d], a.target["parent_" + o.nodeName] = o.nodeValue } catch (t) { globalVar.tracking && console.log(t) } try { a.target.parent_tagName = s.tagName } catch (t) { globalVar.tracking && console.log(t) } for (var g = s, d = 1; 100 > d && (g = g.parentElement, null != g && null != g) ; d++) { try { for (var l, c = g.attributes, u = 0; u < c.length; u++) l = c[u], a.target["parent_" + d + "_" + l.nodeName] = l.nodeValue } catch (t) { globalVar.tracking && console.log(t) } try { a.target["parent_" + d + "_tagName"] = g.tagName } catch (t) { globalVar.tracking && console.log(t) } } } } a.is = this.getInputData(); var m = this.createLogObject(LOG_CONSTANTS.ACTION_TYPE.MOUSE_CLICK, a); m.prepareLogObjectData(this), localStorage.setItem(LOG_CONSTANTS.LOCAL_STORAGE.LOG_CLICK_COOKIE_KEY + m.time, JSON.stringify(m)), this.sendXHRLog(m) } catch (t) { globalVar.tracking && console.log(t) } }, this.mouseMoveAndStopLog = function (t) { try { globalVar.lastMouseMoveStopTime = new Date().getTime(), globalVar.mousePositionX = null == t.pageX ? -1 : t.pageX, globalVar.mousePositionY = null == t.pageY ? -1 : t.pageY, setTimeout(function () { try { var n = new Date().getTime(); if (n - globalVar.lastMouseMoveStopTime >= LOG_CONSTANTS.THRESHOLD.MOUSE_MOUVE_STOP_TIMEOUT) { var a = t.target || t.srcElement, o = logger.createData(); if (null != a && a != null) { try { for (var r, d = a.attributes, s = 0; s < d.length; s++) r = d[s], o.target[r.nodeName] = r.nodeValue } catch (t) { globalVar.tracking && console.log(t) } try { o.target.tagName = a.tagName } catch (t) { globalVar.tracking && console.log(t) } var g = a.parentElement; if (null == g || g == null); else { try { for (var r, d = g.attributes, s = 0; s < d.length; s++) r = d[s], o.target["parent_" + r.nodeName] = r.nodeValue } catch (t) { globalVar.tracking && console.log(t) } try { o.target.parent_tagName = g.tagName } catch (t) { globalVar.tracking && console.log(t) } for (var l = g, s = 1; 100 > s && (l = l.parentElement, null != l && null != l) ; s++) { try { for (var c, u = l.attributes, m = 0; m < u.length; m++) c = u[m], o.target["parent_" + s + "_" + c.nodeName] = c.nodeValue } catch (t) { globalVar.tracking && console.log(t) } try { o.target["parent_" + s + "_tagName"] = l.tagName } catch (t) { globalVar.tracking && console.log(t) } } } } var h = logger.createLogObject(LOG_CONSTANTS.ACTION_TYPE.MOUSE_MOVE_STOP, o); h.prepareLogObjectData(logger), logger.sendLog(h) } } catch (t) { globalVar.tracking && console.log(t) } }, LOG_CONSTANTS.THRESHOLD.MOUSE_MOUVE_STOP_TIMEOUT) } catch (t) { globalVar.tracking && console.log(t) } }, this.enterUpLog = function () { try { var t = this.createData(); t.target.text_search = []; for (var n = 0, a = 0; a < LOG_CONSTANTS.ID_SEARCH_BOXS.length; a++) { var o = LOG_CONSTANTS.ID_SEARCH_BOXS[a], r = document.getElementById(o); if (null != r && r != null) { var d = r.value, s = {}; s.text_search = d, s.id_text_search = o, t.target.text_search[n] = s, n++ } } var g = this.createLogObject(LOG_CONSTANTS.ACTION_TYPE.ENTER_UP, t); g.prepareLogObjectData(this), localStorage.setItem(LOG_CONSTANTS.LOCAL_STORAGE.LOG_ENTER_UP_COOKIE_KEY + g.time, JSON.stringify(g)), this.sendXHRLog(g) } catch (t) { globalVar.tracking && console.log(t) } }, this.scrollLog = function () { try { var t = new Date().getTime(); if (t - globalVar.lastScrollTime >= LOG_CONSTANTS.THRESHOLD.SCROLL_TIMEOUT) { var i = this.createLogObject(LOG_CONSTANTS.ACTION_TYPE.WINDOW_SCROLL, null); i.prepareLogObjectData(this), this.sendLog(i) } } catch (t) { globalVar.tracking && console.log(t) } }, this.timeOnSiteLog = function () { try { var t = new Date().getTime(), i = this.createData(); i.timeOnSite = globalVar.time_on_site, i.timestamp = t, i.is = this.getInputData(); var n = this.createLogObject(LOG_CONSTANTS.ACTION_TYPE.UNLOAD, i); n.prepareLogObjectData(this), localStorage.setItem(LOG_CONSTANTS.LOCAL_STORAGE.LOG_TIME_ON_SITE_KEY + n.time, JSON.stringify(n)), logger.sendXHRLog(n) } catch (t) { globalVar.tracking && console.log(t) } }, this.getBuyCategories = function () { var t = new Set([38, 324, 41, 325, 163, 40, 283, 44, 45, 48, 49, 326, 50, 51, 52, 53, 55, 57, 59]); return t }, this.getRentCategories = function () { var t = new Set([400, 401, 402, 403, 404, 405, 406, 407, 408, 409, 410, 411, 412, 413, 414, 415, 416, 417, 418]); return t }, this.getNewsCategories = function () { var t = new Set([88, 89, 90, 91, 92, 113, 164, 120, 12, 123, 154, 149, 151, 331, 8, 9, 264, 147, 277, 30, 138, 141, 139, 114, 31, 118, 140, 32, 142, 143, 144, 145, 146, 112, 133, 29, 124, 122, 125, 127, 128, 129, 130, 363, 119, 117, 21, 24, 364, 132, 131, 115, 134, 135, 136, 23, 358]); return t }, this.handleBrowserTabActive = function () { globalVar.is_active || (globalVar.start_time_active_tab = new Number(new Date().getTime()), globalVar.is_active = !0) }, this.handleBrowserTabDeactive = function () { globalVar.is_active && (globalVar.time_on_site += new Number(new Date().getTime()) - globalVar.start_time_active_tab, globalVar.is_active = !1) }, this.parseIdFromUrl = function (t) { if (t.match(/^.*-pr([0-9]+)$/)) return t.replace(/^.*-pr([0-9]+)$/, "$1"); if (t.match(/^.*-pd([0-9]+)$/)) return t.replace(/^.*-pd([0-9]+)$/, "$1"); if (t.match(/^.*-ar([0-9]+)$/)) return t.replace(/^.*-ar([0-9]+)$/, "$1"); if (t.match(/^.*-fq([0-9]+)$/)) return t.replace(/^.*-fq([0-9]+)$/, "$1"); if (t.match(/^.*-pj([0-9]+)$/)) { return t.replace(/^.*-pj([0-9]+)$/, "$1") } return t.match(/^.*-ad([0-9]+)$/) ? t.replace(/^.*-ad([0-9]+)$/, "$1") : t.match(/^.*-ib([0-9]+)$/) ? t.replace(/^.*-ib([0-9]+)$/, "$1") : t.match(/^.*-ep([0-9]+)$/) ? t.replace(/^.*-ep([0-9]+)$/, "$1") : t.match(/^.*-at([0-9]+)$/) ? t.replace(/^.*-at([0-9]+)$/, "$1") : null }, this.getHrefIdFromElement = function (t, i) { try { i.h = t.querySelector("a[href][title]").getAttribute("href"), i.i = this.parseIdFromUrl(i.h), i.t = t.querySelector("a[href][title]").getAttribute("title"), i.uid = t.getAttribute("uid") } catch (t) { globalVar.tracking && console.log(t) } }, this.updateUserInfoToCookie = function () { try { var t = this.getCookie(LOG_CONSTANTS.COOKIE.USER_INFO_KEY_COOKIE); if (t && t !== void 0 && "" != t) { var i = JSON.parse(decodeURIComponent(t)); (i || i.email || i.email != userInfo.email) && this.setCookie(LOG_CONSTANTS.COOKIE.USER_INFO_KEY_COOKIE, encodeURIComponent(JSON.stringify(userInfo)), LOG_CONSTANTS.THRESHOLD.USER_INFO_KEY_COOKIE) } else this.setCookie(LOG_CONSTANTS.COOKIE.USER_INFO_KEY_COOKIE, encodeURIComponent(JSON.stringify(userInfo)), LOG_CONSTANTS.THRESHOLD.USER_INFO_KEY_COOKIE) } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewDataDesktop = function () { var t = this.createData(); try { t.ci = bannerContext && null != bannerContext && "" != bannerContext && bannerContext.CateId && null != bannerContext.CateId && "" != bannerContext.CateId ? bannerContext.CateId : null } catch (t) { globalVar.tracking && console.log(t) } try { t.cc = bannerContext && null != bannerContext && "" != bannerContext && bannerContext.CityCode && null != bannerContext.CityCode && "" != bannerContext.CityCode ? bannerContext.CityCode : null } catch (t) { globalVar.tracking && console.log(t) } try { t.di = bannerContext && null != bannerContext && "" != bannerContext && bannerContext.DistrictId && null != bannerContext.DistrictId && "" != bannerContext.DistrictId ? bannerContext.DistrictId : null } catch (t) { globalVar.tracking && console.log(t) } try { t.pi = null == document.getElementById("hdCboProject") ? null : document.getElementById("hdCboProject").value } catch (t) { globalVar.tracking && console.log(t) } try { t.wi = null == document.getElementById("hdCboWard") ? null : document.getElementById("hdCboWard").value } catch (t) { globalVar.tracking && console.log(t) } try { t.si = null == document.getElementById("hdCboStreet") ? null : document.getElementById("hdCboStreet").value } catch (t) { globalVar.tracking && console.log(t) } try { t.uid = null == document.getElementById("product-detail-web") ? null : document.getElementById("product-detail-web").getAttribute("uid") } catch (t) { globalVar.tracking && console.log(t) } return this.getPageViewDetailDesktop(t), this.getImpressionItemsDesktop(t), this.getImpressionNewsDesktop(t), t }, this.getPageViewDetailDesktop = function (t) { try { t.vdi.t = document.title, t.vdi.h = document.URL, t.vdi.i = this.parseIdFromUrl(document.URL), t.vdi.uid = t.uid } catch (t) { globalVar.tracking && console.log(t) } try { t.vdi.uid = t.uid } catch (t) { globalVar.tracking && console.log(t) } this.getPageViewPriceDetailDesktop(t), this.getPageViewAreaDetailDesktop(t), this.getPageViewZoneDetailDesktop(t), this.getPageViewDistrictDetailDesktop(t), this.getPageViewActionTypeDetailDesktop(t), this.getPageViewAddressDetailDesktop(t), this.getPageViewPostTypeDetailDesktop(t), this.getPageViewDatePostDetailDesktop(t) }, this.getPageViewDatePostDetailDesktop = function (t) { if (this.getBuyCategories().has(t.ci)) for (var n = document.querySelectorAll("div.product-config ul.short-detail-2 li"), a = 0; a < n.length; a++) try { if (n[a].innerText.includes("Ng\xE0y \u0111\u0103ng:")) { t.vdi.dp = n[a].querySelector(".sp3").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } else if (this.getRentCategories().has(t.ci)) for (var n = document.querySelectorAll("div[class=\"pm-content-detail\"] div[class=\"left-detail\"] div[style*=\"padding\"]"), a = 0; a < n.length; a++) try { if (n[a].innerText.includes("Ng\xE0y \u0111\u0103ng tin")) { t.vdi.dp = n[a].innerText.substring(13).trim(); break } } catch (t) { globalVar.tracking && console.log(t) } else if (this.getNewsCategories().has(t.ci)) { var n = document.querySelectorAll("div[class=\"date-first\"]"); try { t.vdi.dp = n[0].innerText.trim() } catch (t) { globalVar.tracking && console.log(t) } } }, this.getPageViewPostTypeDetailDesktop = function (t) { if (this.getBuyCategories().has(t.ci)) for (var n = document.querySelectorAll("div.product-config ul.short-detail-2 li"), a = 0; a < n.length; a++) try { if (n[a].innerText.includes("Lo\u1EA1i tin:")) { t.vdi.pt = n[a].querySelector(".sp3").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } else if (this.getRentCategories().has(t.ci)) for (var n = document.querySelectorAll("div[class=\"pm-content-detail\"] div[class=\"left-detail\"] div[style*=\"padding\"]"), a = 0; a < n.length; a++) try { if (n[a].innerText.includes("Lo\u1EA1i tin rao")) { t.vdi.pt = n[a].innerText.substring(12).trim(); break } } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewAddressDetailDesktop = function (t) { if (this.getBuyCategories().has(t.ci)) for (var n = document.querySelectorAll("div.box-round-grey3 div.row-1"), a = 0; a < n.length; a++) try { if (n[a].innerText.includes("\u0110\u1ECBa ch\u1EC9:")) { t.vdi.ad = n[a].querySelector(".r2").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } else if (this.getRentCategories().has(t.ci)) for (var o = document.querySelectorAll("div[class=\"left-detail\"] div[style*=\"padding\"]"), a = 0; a < o.length; a++) try { if (o[a].querySelector("div[class=\"left\"]").innerText.toLowerCase().trim().includes("\u0110\u1ECBa ch\u1EC9")) { t.vdi.ad = o[a].querySelector("div[class=\"right\"]").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewActionTypeDetailDesktop = function (t) { if (this.getBuyCategories().has(t.ci)) try { for (var n = document.querySelectorAll("div.box-round-grey3 div.row-1"), a = 0; a < n.length; a++) try { if (n[a].innerText.includes("Lo\u1EA1i tin \u0111\u0103ng:")) { t.vdi.o = n[a].querySelector(".r2").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } } catch (t) { globalVar.tracking && console.log(t) } else if (this.getRentCategories().has(t.ci)) try { for (var o = document.querySelectorAll("div[class=\"left-detail\"] div[style*=\"padding\"]"), a = 0; a < o.length; a++) try { if (o[a].querySelector("div[class=\"left\"]").innerText.toLowerCase().trim().includes("Lo\u1EA1i tin rao")) { t.vdi.o = o[a].querySelector("div[class=\"right\"]").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewZoneDetailDesktop = function (t) { if (this.getBuyCategories().has(t.ci) || this.getRentCategories().has(t.ci)) try { t.vdi.zn = null != document.querySelector("span[class*=\"diadiem-title\"] a") && null != document.querySelector("span[class*=\"diadiem-title\"] a") ? document.querySelector("span[class*=\"diadiem-title\"] a").innerText : null; for (var n = document.querySelectorAll("div.box-round-grey3 div.row-1"), a = 0; a < n.length; a++) try { if (n[a].innerText.includes("Lo\u1EA1i tin \u0111\u0103ng:")) { t.vdi.o = n[a].querySelector(".r2").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewDistrictDetailDesktop = function (t) { if (this.getBuyCategories().has(t.ci) || this.getRentCategories().has(t.ci)) try { if (t.vdi.dn = null != document.querySelector("span[class*=\"diadiem-title\"]") && null != document.querySelector("span[class*=\"diadiem-title\"]") ? document.querySelector("span[class*=\"diadiem-title\"]").innerText : null, null != t.vdi.zn && null != t.vdi.zn) { var n = t.vdi.dn.indexOf(t.vdi.zn); 0 < n && n + t.vdi.zn.length + 3 < t.vdi.dn.length && (t.vdi.dn = t.vdi.dn.substring(n + t.vdi.zn.length + 3), t.vdi.dn = t.vdi.dn.trim()) } } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewAreaDetailDesktop = function (t) { if (this.getBuyCategories().has(t.ci) || this.getRentCategories().has(t.ci)) try { for (var n = document.querySelectorAll("div.short-detail-wrap ul.short-detail-2 li"), a = 0; a < n.length; a++) try { if (n[a].innerText.includes("Di\u1EC7n t\xEDch:")) { t.vdi.p = n[a].querySelector(".sp2").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewPriceDetailDesktop = function (t) { if (this.getBuyCategories().has(t.ci) || this.getRentCategories().has(t.ci)) for (var n = document.querySelectorAll("div.short-detail-wrap ul.short-detail-2 li"), a = 0; a < n.length; a++) try { if (n[a].innerText.includes("M\u1EE9c gi\xE1:")) { t.vdi.p = n[a].querySelector(".sp2").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewPriceItemDesktop = function (t, n, a) { if (document.URL.endsWith("batdongsan.com.vn") || document.URL.endsWith("batdongsan.com.vn/")) for (var o = a.querySelectorAll("div[class=\"left\"]"), r = 0; r < o.length; r++) try { if (o[r].innerText && null != o[r].innerText && "gi\xE1" == o[r].innerText.toLowerCase() && (e = o[r].parentNode, null != o[r].parentNode && null != o[r].parentNode && o[r].parentNode.innerText && null != o[r].parentNode.innerText && "" != o[r].parentNode.innerText.trim())) { var d = o[r].parentNode.innerText.split(":"); if (2 == d.length) { n.p = d[1].trim(); break } } } catch (t) { globalVar.tracking && console.log(t) } else if (document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue") || document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue/") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac/") || this.getRentCategories().has(t.ci)) try { n.p = a.querySelector("span[class*=\"product-price\"]").innerText.trim() } catch (t) { globalVar.tracking && console.log(t) } else if (this.getBuyCategories().has(t.ci)) try { n.p = a.querySelector("div.pro-price").innerText.trim() } catch (t) { globalVar.tracking && console.log(t) } else if (document.URL.endsWith("batdongsan.com.vn/tin-tuc") || document.URL.endsWith("batdongsan.com.vn/tin-tuc/") || this.getNewsCategories().has(t.ci)); }, this.getPageViewAreaItemDesktop = function (t, n, a) { if (document.URL.endsWith("batdongsan.com.vn") || document.URL.endsWith("batdongsan.com.vn/")) for (var o = a.querySelectorAll("div[class=\"left\"]"), r = 0; r < o.length; r++) try { if (o[r].innerText && null != o[r].innerText && "di\u1EC7n t\xEDch" == o[r].innerText.toLowerCase() && (e = o[r].parentNode, null != o[r].parentNode && null != o[r].parentNode && o[r].parentNode.innerText && null != o[r].parentNode.innerText && "" != o[r].parentNode.innerText.trim())) { var d = o[r].parentNode.innerText.split(":"); if (2 == d.length) { n.a = d[1].trim(); break } } } catch (t) { globalVar.tracking && console.log(t) } else if (document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue") || document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue/") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac/") || this.getRentCategories().has(t.ci)) try { n.a = a.querySelector("span[class*=\"product-area\"]").innerText.trim() } catch (t) { globalVar.tracking && console.log(t) } else if (this.getBuyCategories().has(t.ci)) try { n.a = a.querySelector("div.pro-m2").innerText.trim() } catch (t) { globalVar.tracking && console.log(t) } else if (document.URL.endsWith("batdongsan.com.vn/tin-tuc") || document.URL.endsWith("batdongsan.com.vn/tin-tuc/") || this.getNewsCategories().has(t.ci)); }, this.getPageViewDistrictItemDesktop = function (t, n, a) { if (document.URL.endsWith("batdongsan.com.vn") || document.URL.endsWith("batdongsan.com.vn/")) for (var o = a.querySelectorAll("div[class=\"left\"]"), r = 0; r < o.length; r++) try { if (o[r].innerText && null != o[r].innerText && "qu?n/huy?n" == o[r].innerText.toLowerCase() && null != o[r].parentNode && null != o[r].parentNode) { var d = o[r].parentNode.querySelector("span"); if (null != d && null != d) { n.dn = d.innerText.trim(); break } } } catch (t) { globalVar.tracking && console.log(t) } else if (document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue") || document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue/") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac/") || this.getRentCategories().has(t.ci)) try { n.dn = a.querySelector("span[class*=\"product-city-dist\"]").innerText.trim() } catch (t) { globalVar.tracking && console.log(t) } else if (this.getBuyCategories().has(t.ci)) try { n.dn = a.querySelector("div.pro-adress").innerText.trim() } catch (t) { globalVar.tracking && console.log(t) } else if (document.URL.endsWith("batdongsan.com.vn/tin-tuc") || document.URL.endsWith("batdongsan.com.vn/tin-tuc/") || this.getNewsCategories().has(t.ci)); }, this.getPageViewDatePostItemDesktop = function (t, i, n) { if (document.URL.endsWith("batdongsan.com.vn") || document.URL.endsWith("batdongsan.com.vn/")) try { i.dp = n.querySelector("div[class*=\"p-bottom-right\"]").innerText.trim() } catch (t) { globalVar.tracking && console.log(t) } else if (document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue") || document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue/") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac/") || this.getRentCategories().has(t.ci)) try { i.dp = n.querySelector("div[class*=\"floatright\"]").innerText.trim() } catch (t) { globalVar.tracking && console.log(t) } else if (this.getBuyCategories().has(t.ci)) try { i.dp = n.querySelector("div[class*=\"floatright\"]").innerText.trim() } catch (t) { globalVar.tracking && console.log(t) } else if (document.URL.endsWith("batdongsan.com.vn/tin-tuc") || document.URL.endsWith("batdongsan.com.vn/tin-tuc/") || this.getNewsCategories().has(t.ci)); }, this.getImpressionItemsDesktop = function (t) { var n = document.querySelectorAll("div.list-product-area ul.ul-list-product li"); n && 0 != n.length || (n = document.querySelectorAll("div.product-lists div.product-item ")); for (var a = 0; n && n != null && a < n.length; a++) { var r = n[a], d = new o; this.getLocationFromElement(r, d), d.uid = r.getAttribute("uid"); try { var s = r.querySelector("a[title]"); null != s && s != null && (d.t = s.title, d.h = s.href, d.i = this.parseIdFromUrl(d.h)) } catch (t) { globalVar.tracking && console.log(t) } this.getPageViewPriceItemDesktop(t, d, r), this.getPageViewAreaItemDesktop(t, d, r), this.getPageViewDistrictItemDesktop(t, d, r), this.getPageViewDatePostItemDesktop(t, d, r), t.vdis[a] = d } }, this.getImpressionNewsDesktop = function (t) { this.getImpressionNews(t) }, this.getImpressionNewsMobile = function (t) { this.getImpressionNews(t) }, this.getImpressionNews = function (t) { for (var n = new Map, a = document.querySelectorAll("a[href*=\"-ar\"][title]"), r = 0; r < a.length; r++) { var d = a[r], s = d.href; if (!n.has(key) && s.match(/^.*-ar([0-9]+)$/) || s.match(/^.*-at([0-9]+)$/)) { var g = new o; g.h = s, g.t = d.title, g.i = this.parseIdFromUrl(g.h), n.set(s, g) } } if (0 < n.size) { var l = 0; n.forEach(i=> { t.vdns[l] = i, l++ }) } }, this.getPageViewDataMobile = function () { var t = this.createData(); try { t.ci = bannerContext && null != bannerContext && "" != bannerContext && bannerContext.CateId && null != bannerContext.CateId && "" != bannerContext.CateId ? bannerContext.CateId : null } catch (t) { globalVar.tracking && console.log(t) } try { t.cc = bannerContext && null != bannerContext && bannerContext.CityCode && null != bannerContext.CityCode && "" != bannerContext.CityCode ? bannerContext.CityCode : null } catch (t) { globalVar.tracking && console.log(t) } try { t.di = bannerContext && null != bannerContext && bannerContext.DistrictId && null != bannerContext.DistrictId && "" != bannerContext.DistrictId ? bannerContext.DistrictId : null } catch (t) { globalVar.tracking && console.log(t) } try { var n = document.getElementById("ContentPlaceHolder_ProductDetail1_linkProject"); n && null != n && n.href && null != n.href && (t.pi = this.parseIdFromUrl(n.href)) } catch (t) { globalVar.tracking && console.log(t) } try { if (null != t.di && null != t.di && "" != t.di) { var a = document.getElementById("cboWardProduct"), o = a.parentElement.querySelector("strong").innerText.trim(); if (!o.toLowerCase().includes("--ch\u1ECDn")) for (var r = a.querySelectorAll("option"), d = 0; d < r.length; d++) if (o.toLowerCase().trim() == r[d].innerText.trim().toLowerCase()) { t.wi = r[d].value ? r[d].value : null; break } } } catch (t) { globalVar.tracking && console.log(t) } try { if (null != t.di && null != t.di && "" != t.di) { var s = document.getElementById("cboStreetProduct"), o = s.parentElement.querySelector("strong").innerText.trim().toLowerCase(); if (!o.includes("--ch\u1ECDn")) for (var r = s.querySelectorAll("option"), d = 0; d < r.length; d++) if (o == r[d].innerText.toLowerCase().trim()) { t.si = r[d].value ? r[d].value : null; break } } } catch (t) { globalVar.tracking && console.log(t) } try { t.uid = null == document.getElementById("product-detail-wap") ? null : document.getElementById("product-detail-wap").getAttribute("uid") } catch (t) { globalVar.tracking && console.log(t) } return this.getPageViewDetailMobile(t), this.getImpressionItemsMobile(t), this.getImpressionNewsMobile(t), t }, this.getPageViewDatePostDetailMobile = function (t) { try { if (this.getRentCategories().has(t.ci)) for (var n = document.querySelectorAll("div[class=\"sr-content\"] div[class=\"o-info\"] div[class=\"o-i-field\"]"), a = 0; a < n.length; a++) try { if ("Ng\xE0y \u0111\u0103ng tin" == n[a].querySelector("span[class*=\"text-blue\"]").innerText.trim().toLowerCase()) { t.vdi.dp = n[a].querySelector("span[class*=\"-value-\"]").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } else if (this.getBuyCategories().has(t.ci)) for (var n = document.querySelectorAll("div.sr-content ul.short-detail-2 li"), a = 0; a < n.length; a++) try { if ("Ng\xE0y \u0111\u0103ng" == n[a].querySelector(".sp1").innerText.trim()) { t.vdi.dp = n[a].querySelector(".sp3").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewPostTypeDetailMobile = function (t) { try { if (this.getBuyCategories().has(t.ci)) for (var n = document.querySelectorAll("div.sr-content ul.short-detail-2 li"), a = 0; a < n.length; a++) try { if ("H\u1EA1ng tin:" == n[a].querySelector(".sp1").innerText.trim()) { t.vdi.pt = n[a].querySelector(".sp3").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewAddressDetailMobile = function (t) { try { if (this.getRentCategories().has(t.ci)) for (var n = document.querySelectorAll("div[class=\"sr-content\"] div[class=\"o-info\"] div[class=\"o-i-field\"]"), a = 0; a < n.length; a++) try { if ("\u0111\u1ECBa ch\u1EC9" == n[a].querySelector("span[class*=\"text-blue\"]").innerText.trim().toLowerCase()) { t.vdi.ad = n[a].querySelector("span[class*=\"-value-\"]").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } else if (this.getBuyCategories().has(t.ci)) for (var n = document.querySelectorAll("div.blockInfo div.text-row"), a = 0; a < n.length; a++) try { if ("\u0110\u1ECBa ch\u1EC9:" == n[a].querySelector(".text-left").innerText.trim()) { t.vdi.ad = n[a].querySelector(".text-right").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewActionTypeDetailMobile = function (t) { try { if (this.getRentCategories().has(t.ci)) for (var n = document.querySelectorAll("div[class=\"sr-content\"] div[class=\"o-info\"] div[class=\"o-i-field\"]"), a = 0; a < n.length; a++) try { if ("Lo\u1EA1i tin rao" == n[a].querySelector("span[class*=\"text-blue\"]").innerText.trim().toLowerCase()) { t.vdi.o = n[a].querySelector("span[class*=\"-value-\"]").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } else if (this.getBuyCategories().has(t.ci)) for (var n = document.querySelectorAll("div.blockInfo div.text-row"), a = 0; a < n.length; a++) try { if ("Lo\u1EA1i tin \u0111\u0103ng:" == n[a].querySelector(".text-left").innerText.trim()) { t.vdi.o = n[a].querySelector(".text-right").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewZoneDetailMobile = function (t) { try { if (this.getRentCategories().has(t.ci)) for (var n = document.querySelectorAll("div[class=\"sr-content\"] div[class=\"o-info\"] div[class=\"o-i-field\"]"), a = 0; a < n.length; a++) try { if ("\u0111\u1ECBa ch\u1EC9" == n[a].querySelector("span[class*=\"text-blue\"]").innerText.trim().toLowerCase()) { t.vdi.zn = n[a].querySelector("span[class*=\"-value-\"]").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } else if (this.getBuyCategories().has(t.ci)) { var o = document.querySelector("div[class*=\"diadiem-title\"]").innerText.trim(), r = document.querySelector("div[class*=\"diadiem-title\"] a").innerText.trim(); o = o.substring(o.indexOf(r) + r.length, o.length).trim(), t.vdi.dn = o.substring(o.indexOf("-") + 1, o.length).trim() } } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewDistrictDetailMobile = function (t) { try { if (this.getRentCategories().has(t.ci)) for (var n = document.querySelectorAll("div[class=\"sr-content\"] div[class=\"o-info\"] div[class=\"o-i-field\"]"), a = 0; a < n.length; a++) try { if ("\u0111\u1ECBa ch\u1EC9" == n[a].querySelector("span[class*=\"text-blue\"]").innerText.trim().toLowerCase()) { t.vdi.dn = n[a].querySelector("span[class*=\"-value-\"]").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } else this.getBuyCategories().has(t.ci) && (t.vdi.zn = document.querySelector("div[class*=\"diadiem-title\"] a").innerText.trim()) } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewAreaDetailMobile = function (t) { try { this.getRentCategories().has(t.ci) ? t.vdi.a = document.getElementById("ContentPlaceHolder_AdNewsDetail1_Area").querySelector("span[class*=\"-value-\"]").innerText.trim() : this.getBuyCategories().has(t.ci) && (t.vdi.a = document.querySelector("div.list-info li.area div.txtContent").innerText.trim()) } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewPriceDetailMobile = function (t) { try { this.getRentCategories().has(t.ci) ? t.vdi.p = document.getElementById("ContentPlaceHolder_AdNewsDetail1_price").querySelector("span[class=\"o-value-red\"]").innerText.trim() : this.getBuyCategories().has(t.ci) && (t.vdi.p = document.querySelector("div.list-info li.price div.txtContent").innerText.trim()) } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewDetailMobile = function (t) { try { t.vdi.t = document.title, t.vdi.h = document.URL, t.vdi.i = this.parseIdFromUrl(document.URL), t.vdi.uid = t.uid } catch (t) { globalVar.tracking && console.log(t) } this.getPageViewPriceDetailMobile(t), this.getPageViewAreaDetailMobile(t), this.getPageViewDistrictDetailMobile(t), this.getPageViewZoneDetailMobile(t), this.getPageViewActionTypeDetailMobile(t), this.getPageViewAddressDetailMobile(t), this.getPageViewPostTypeDetailMobile(t), this.getPageViewDatePostDetailMobile(t) }, this.getPageViewPriceItemMobile = function (t, n, a) { try { if (document.URL.endsWith("batdongsan.com.vn/") || document.URL.endsWith("batdongsan.com.vn")) n.p = a.querySelectorAll("span[class=\"sp-info\"]")[0].innerText.trim(); else if (document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue") || document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue/") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac/") || this.getRentCategories().has(t.ci)) for (var o = a.querySelectorAll("span[class*=\"sp-info\"]"), r = 0; r < o.length; r++) try { if ("gi\xE1:" == o[r].querySelector("b").innerText.trim().toLowerCase()) { n.p = o[r].querySelector("strong").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } else if (this.getBuyCategories().has(t.ci)) n.p = null != t.vdi && null != t.vdi && null != t.vdi.i && null != t.vdi.i ? a.querySelector("div.sr-info span.sp-bold").innerText.trim() : a.querySelector("div.sr-info span.sp-bold").innerText.trim(); else if (document.URL.endsWith("batdongsan.com.vn/tin-tuc") || document.URL.endsWith("batdongsan.com.vn/tin-tuc/") || this.getNewsCategories().has(t.ci)); } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewAreaItemMobile = function (t, n, a) { try { if (document.URL.endsWith("batdongsan.com.vn/") || document.URL.endsWith("batdongsan.com.vn")) n.a = a.querySelectorAll("span[class=\"sp-info\"]")[1].innerText.trim(); else if (document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue") || document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue/") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac/") || this.getRentCategories().has(t.ci)) for (var o = a.querySelectorAll("span[class*=\"sp-info\"]"), r = 0; r < o.length; r++) try { if ("di\u1EC7n t\xEDch:" == o[r].querySelector("b").innerText.trim().toLowerCase()) { n.a = o[r].querySelector("strong").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } else if (this.getBuyCategories().has(t.ci)) n.a = null != t.vdi && null != t.vdi && null != t.vdi.i && null != t.vdi.i ? a.querySelector("div.sr-info span.sp-address").innerText.trim() : a.querySelector("div.sr-info span.sp-address").innerText.trim(); else if (document.URL.endsWith("batdongsan.com.vn/tin-tuc") || document.URL.endsWith("batdongsan.com.vn/tin-tuc/") || this.getNewsCategories().has(t.ci)); } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewDistrictItemMobile = function (t, n, a) { try { if (document.URL.endsWith("batdongsan.com.vn/") || document.URL.endsWith("batdongsan.com.vn")) n.dn = a.querySelectorAll("span[class=\"sp-info\"]")[2].innerText.trim(); else if (document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue") || document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue/") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac/") || this.getRentCategories().has(t.ci)) for (var o = a.querySelectorAll("span[class*=\"sp-info\"]"), r = 0; r < o.length; r++) try { if ("\u0110\u1ECBa ch\u1EC9:" == o[r].querySelector("b").innerText.trim().toLowerCase()) { n.dn = o[r].querySelector("strong").innerText.trim(), n.ad = o[r].querySelector("strong").innerText.trim(); break } } catch (t) { globalVar.tracking && console.log(t) } else if (this.getBuyCategories().has(t.ci)) { if (null != t.vdi && null != t.vdi && null != t.vdi.i && null != t.vdi.i); else { var d = a.querySelector("div[class*=\"sr-info\"] span[class*=\"sp-address\"]").innerText.trim(), s = a.querySelector("div[class*=\"sr-info\"] span[class*=\"sp-uptime\"]").innerText.trim(); n.dn = d.substring(0, d.indexOf(s)).trim() } } else if (document.URL.endsWith("batdongsan.com.vn/tin-tuc") || document.URL.endsWith("batdongsan.com.vn/tin-tuc/") || this.getNewsCategories().has(t.ci)); } catch (t) { globalVar.tracking && console.log(t) } }, this.getPageViewDatePostItemMobile = function (t, i, n) { try { if (document.URL.endsWith("batdongsan.com.vn/") || document.URL.endsWith("batdongsan.com.vn")); else if (document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue") || document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue/") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac/") || this.getRentCategories().has(t.ci)) { var a = n.querySelector("h3 span[style]").innerText.trim(); 0 <= a.indexOf("(") && (a = a.substring(a.indexOf("(") + 1, a.length).trim()), 0 <= a.indexOf(")") && (a = a.substring(0, a.indexOf(")")).trim()), i.dp = a } else if (this.getBuyCategories().has(t.ci)) i.dp = null != t.vdi && null != t.vdi && null != t.vdi.i && null != t.vdi.i ? n.querySelector("div.sr-info span.sp-uptime").getAttribute("uptime") : n.querySelector("div.sr-info span.sp-uptime").getAttribute("uptime"); else if (document.URL.endsWith("batdongsan.com.vn/tin-tuc") || document.URL.endsWith("batdongsan.com.vn/tin-tuc/") || this.getNewsCategories().has(t.ci)); } catch (t) { globalVar.tracking && console.log(t) } }, this.getImpressionItemsMobile = function (t) { try { var n = null; if (document.URL.endsWith("batdongsan.com.vn/") || document.URL.endsWith("batdongsan.com.vn") ? n = document.querySelectorAll("ul[id=\"ul_for\"] li[uid]") : document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue") || document.URL.endsWith("batdongsan.com.vn/can-mua-can-thue/") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac") || document.URL.endsWith("batdongsan.com.vn/mua-cac-loai-bat-dong-san-khac/") || this.getRentCategories().has(t.ci) ? n = document.querySelectorAll("ul[class*=\"s-list\"] li[uid]") : this.getBuyCategories().has(t.ci) ? (n = document.querySelectorAll("div#list-product-area div.item"), (!n || 0 == n.length) && (n = document.querySelectorAll("div#broker-product-list ul#product-list-wap li[uid]"))) : document.URL.endsWith("batdongsan.com.vn/tin-tuc") || document.URL.endsWith("batdongsan.com.vn/tin-tuc/") || this.getNewsCategories().has(t.ci), 0 < n.length) for (var a = 0; null != n && null != n && a < n.length; a++) { var r = n[a], d = new o; this.getLocationFromElement(r, d), this.getHrefIdFromElement(r, d), this.getPageViewPriceItemMobile(t, d, r), this.getPageViewAreaItemMobile(t, d, r), this.getPageViewDistrictItemMobile(t, d, r), this.getPageViewDatePostItemMobile(t, d, r), t.vdis[a] = d } else if (this.getRentCategories().has(t.ci) && null != t.vdi.i && null != t.vdi.i) { n = document.querySelectorAll("ul[class*=\"ul-other-news\"] li a[href][title]"); for (var a = 0; a < n.length; a++) try { var d = new o; d.h = n[a].getAttribute("href"), d.i = this.parseIdFromUrl(d.h), d.t = n[a].getAttribute("title"), t.vdis[a] = d } catch (t) { globalVar.tracking && console.log(t) } } } catch (t) { globalVar.tracking && console.log(t) } } } catch (t) { globalVar.tracking && console.log(t) } } var logger = new Logger; function loggerAddSearchBoxEventLog() { try { for (var t, n = 0; n < LOG_CONSTANTS.ID_SEARCH_BOXS.length; n++) t = LOG_CONSTANTS.ID_SEARCH_BOXS[n], null != document.getElementById(t) && null != document.getElementById(t) && document.getElementById(t).addEventListener("keyup", function (t) { t.keyCode == LOG_CONSTANTS.KEY_CODE.ENTER && logger.enterUpLog() }) } catch (t) { globalVar.tracking && console.log(t) } } function loggerUpdateUserInfo() { try { var t = new XMLHttpRequest; t.onreadystatechange = function () { if (t.readyState == XMLHttpRequest.DONE && 200 <= t.status && 300 > t.status) { var i = t.responseText; if (i) { var n = JSON.parse(i); n && null != n && n.email && void 0 !== n.email && "" != n.email && n.email != userInfo.email && (userInfo.email = n.email, userInfo.mobile = n.mobile, userInfo.name = n.name, userInfo.id = n.id, userInfo.identify_card_number = n.identify_card_number, userInfo.age = n.age, userInfo.time = new Date().getTime(), logger.updateUserInfoToCookie()) } } }, t.open("GET", LOG_CONSTANTS.URL.USER_HANDLER, !0), t.withCredentials = !0, t.send() } catch (t) { globalVar.tracking && console.log(t) } } var allKeyLocalStorage = Object.keys(localStorage); try { for (var key, i = 0; i < allKeyLocalStorage.length; i++) if (key = allKeyLocalStorage[i], key.startsWith(LOG_CONSTANTS.LOCAL_STORAGE.LOG_TIME_ON_SITE_KEY)) { var logTimeOnSiteStr = localStorage.getItem(key); if (logTimeOnSiteStr && void 0 !== logTimeOnSiteStr && "" != logTimeOnSiteStr) { var logTimeOnSiteObj = JSON.parse(logTimeOnSiteStr); localStorage.removeItem(key), logger.sendLog(logTimeOnSiteObj) } } } catch (t) { globalVar.tracking && console.log(t) } try { for (var key, i = 0; i < allKeyLocalStorage.length; i++) if (key = allKeyLocalStorage[i], key.startsWith(LOG_CONSTANTS.LOCAL_STORAGE.LOG_CLICK_COOKIE_KEY)) { var logTimeOnSiteStr = localStorage.getItem(key); if (logTimeOnSiteStr && void 0 !== logTimeOnSiteStr && "" != logTimeOnSiteStr) { var logClickObj = JSON.parse(logTimeOnSiteStr); localStorage.removeItem(key), logger.sendLog(logTimeOnSiteObj) } } } catch (t) { globalVar.tracking && console.log(t) } try { for (var key, i = 0; i < allKeyLocalStorage.length; i++) if (key = allKeyLocalStorage[i], key.startsWith(LOG_CONSTANTS.LOCAL_STORAGE.LOG_ENTER_UP_COOKIE_KEY)) { var logEnterUpStr = localStorage.getItem(key); if (null != logEnterUpStr && void 0 !== logEnterUpStr && "" != logEnterUpStr) { var logEnterUpObj = JSON.parse(logEnterUpStr); localStorage.removeItem(key), logger.sendLog(logEnterUpObj) } } } catch (t) { globalVar.tracking && console.log(t) } try { var userInfoStr = logger.getCookie(LOG_CONSTANTS.COOKIE.USER_INFO_KEY_COOKIE), needGetUserInfo = !0; if (userInfoStr && userInfoStr !== void 0 && "" != userInfoStr) { try { var objUserInfo = JSON.parse(userInfoStr); userInfoStr = encodeURIComponent(userInfoStr), logger.setCookie(LOG_CONSTANTS.COOKIE.USER_INFO_KEY_COOKIE, userInfoStr, LOG_CONSTANTS.THRESHOLD.USER_INFO_KEY_COOKIE) } catch (t) { } var objUserInfo = JSON.parse(decodeURIComponent(userInfoStr)); null != objUserInfo && objUserInfo != null && null != objUserInfo.email && objUserInfo.email != null && (userInfo.name = objUserInfo.name, userInfo.mobile = objUserInfo.mobile, userInfo.email = objUserInfo.email, userInfo.id = objUserInfo.id, userInfo.identify_card_number = objUserInfo.identify_card_number, userInfo.age = objUserInfo.age, userInfo.time = objUserInfo.time, userInfo.time + 86400000 < new Date().getTime() && (needGetUserInfo = !1)) } needGetUserInfo && loggerUpdateUserInfo() } catch (t) { globalVar.tracking && console.log(t) } try { var ipInformation = logger.getIPLocationAddress(); (ipInformation || ipInformation == null) && logger.getIPLocationAddressFromAPI() } catch (t) { globalVar.tracking && console.log(t) } try { LOG_CONSTANTS.current_pagey_offset = window.pageYOffset, globalVar.loadedTime = new Date().getTime(), globalVar.isLogPageView || (globalVar.isLogPageView = !0, logger.pageViewLog()) } catch (t) { globalVar.tracking && console.log(t) } try { globalVar.loggerAndSearchTextBox || (globalVar.loggerAndSearchTextBox = !0, loggerAddSearchBoxEventLog()) } catch (t) { globalVar.tracking && console.log(t) } try { globalVar.addMouseClickEvent || (globalVar.addMouseClickEvent = !0, window.addEventListener ? window.addEventListener("mousedown", function (t) { logger.mouseClickLog(t) }) : window.attachEvent && window.attachEvent("mousedown", function (t) { logger.mouseClickLog(t) })) } catch (t) { globalVar.tracking && console.log(t) } try { globalVar.addScrollLog || (globalVar.addScrollLog = !0, window.onscroll = function () { globalVar.lastScrollTime = new Date().getTime(), setTimeout(function () { logger.scrollLog() }, LOG_CONSTANTS.THRESHOLD.SCROLL_TIMEOUT) }) } catch (t) { globalVar.tracking && console.log(t) } try { globalVar.addBeforeUnload || (globalVar.addBeforeUnload = !0, window.addEventListener ? window.addEventListener("beforeunload", function () { logger.handleBrowserTabDeactive(), logger.timeOnSiteLog() }) : window.attachEvent && window.attachEvent("beforeunload", function () { logger.handleBrowserTabDeactive(), logger.timeOnSiteLog() })) } catch (t) { globalVar.tracking && console.log(t) } try { globalVar.addMouseMoveAndStopEvent || (globalVar.addMouseMoveAndStopEvent = !0, window.addEventListener ? window.addEventListener("mousemove", function (t) { logger.mouseMoveAndStopLog(t) }) : window.attachEvent && window.attachEvent("mousemove", function (t) { logger.mouseMoveAndStopLog(t) })) } catch (t) { globalVar.tracking && console.log(t) } try { var script_imported = document.createElement("script"); script_imported.src = LOG_CONSTANTS.URL.EXPERIMENTAL_DESIGN_JS, null != document.body && document.body != null ? document.body.appendChild(script_imported) : document.head.appendChild(script_imported) } catch (t) { globalVar.tracking && console.log(t) } globalVar.start_time_active_tab = new Number(new Date().getTime()), document.addEventListener("visibilitychange", function () { document.hidden ? logger.handleBrowserTabDeactive() : logger.handleBrowserTabActive() }, !1), window.addEventListener("focus", function () { logger.handleBrowserTabActive() }, !1), window.addEventListener("blur", function () { logger.handleBrowserTabDeactive() }, !1);